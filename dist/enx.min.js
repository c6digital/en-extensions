(()=>{var Ie=Object.defineProperty;var De=(n,e)=>{for(var t in e)Ie(n,t,{get:e[t],enumerable:!0})};var ue={};De(ue,{addMaxLength:()=>He,disableSubmitButton:()=>Ue,displayDonationAmt:()=>Be,enableSubmitButton:()=>Xe,fetchJSONP:()=>Ee,getCampaignData:()=>ce,getClientID:()=>be,getComponentAttribute:()=>S,getComponentAttributes:()=>_,getCurrency:()=>ne,getCurrencySymbol:()=>qe,getDataCenter:()=>xe,getDataFromStorage:()=>$e,getENFieldValue:()=>C,getENSupporterData:()=>P,getENValidators:()=>ge,getElementsOfComponent:()=>f,getElementsWithComponentAttribute:()=>I,getEnPageLocale:()=>M,getFirstElementWithComponentAttribute:()=>A,getMPData:()=>ve,getMPPhotoUrl:()=>B,getNextPageUrl:()=>te,getVisibleValidators:()=>fe,giftAidCalculation:()=>Re,log:()=>u,saveDataToStorage:()=>Ve,saveDonationAmtToStorage:()=>Fe,saveFieldValueToSessionStorage:()=>we,setENFieldValue:()=>ee,shuffleArray:()=>le,transformEnxClassesToDataAttributes:()=>We,updateCurrentYear:()=>Je,updateNextPageUrl:()=>Oe,validateVisibleFields:()=>ae});function C(n,e=!0){let t=n.split(".")[1],r=window.EngagingNetworks.require._defined.enDefaults.getFieldValue(t);if(r||(r=P(t,!1),e&&r))return r;let o=document.querySelectorAll(`[name="${n}"]`);for(let i of o)if(i.type==="checkbox"||i.type==="radio"){if(i.checked)return i.value}else return i.value;return null}function P(n,e=!0){return e&&(n=n.split(".")[1]),window.EngagingNetworks.require._defined.enDefaults.getSupporterData(n)}function ee(n,e,t=!0){t&&(n=n.split(".")[1]),window.EngagingNetworks.require._defined.enDefaults.setFieldValue(n,e)}function ge(){return window.EngagingNetworks.require._defined.enValidation.validation.validators}function fe(){return ge().filter(n=>!!document.querySelector("[class*='enx-multistep:active'] .en__field--"+n.field))}function ae(){return fe().map(e=>(e.hideMessage(),!e.isVisible()||e.test())).every(e=>e)}function le(n){for(var e=n.length,t,r;e;)r=Math.floor(Math.random()*e--),t=n[e],n[e]=n[r],n[r]=t;return n}function te(){return document.querySelector("form.en__component--page")?.getAttribute("action")??""}async function ve(n,e){try{return await(await fetch(`https://members-api.parliament.uk/api/Members/Search?skip=0&take=1&Name=${n}&Location=${e}`)).json()}catch{return!1}}async function B(n,e){let t=await ve(n,e);return t.items[0]?t.items[0].value.thumbnailUrl:(console.log("No MP found for",n,e),"")}function M(){return window.pageJson.locale.substring(0,2)||"en"}function ne(){return C("transaction.paycurrency")||C("transaction.currency")||"USD"}function qe(){return 1 .toLocaleString(M(),{style:"currency",currency:ne()}).replace("1.00","")}function we(n,e=null){e||(e=n),sessionStorage.setItem(e,C(n))}function Fe(){we("transaction.donationAmt","donationAmt")}function Be(){let n=document.querySelector(".display-donation-amt"),e=sessionStorage.getItem("donationAmt");n&&e&&(n.textContent=e)}function Re(){let n=document.querySelector(".gift-aid-calculation"),e=sessionStorage.getItem("donationAmt");if(n&&e){let t=e/4*5;t%1!==0&&(t=t.toFixed(2)),n.querySelector(".donation-amt").textContent=e,n.querySelector(".gift-aid-amt").textContent=t.toString(),n.style.display="block"}}function u(n){window.ENXConfig.debug&&console.log(`%c[ENX]: ${n}`,"color: #241C15; background-color: #FF3EBF; padding: 4px; font-weight: 400;")}function Oe(){document.querySelector(".next-button")?.setAttribute("href",te())}function Ve(n=[]){n.forEach(e=>{let t=document.querySelector(e.storageValue);t&&t.value&&sessionStorage.setItem(e.storageKey,t.value)})}function $e(n=[]){n.forEach(function(e){let t=document.querySelector(e.target);t&&(t.innerText=sessionStorage.getItem(e.key))})}function Je(){document.querySelectorAll(".current-year").forEach(n=>{n.innerText=new Date().getFullYear()})}function He(n){n.forEach(e=>{document.querySelector(e.key)?.setAttribute("maxlength",e.maxlength)})}function Ue(n=!0){document.querySelectorAll(".en__submit button").forEach(t=>{t.disabled=!0,n&&(t.innerHTML=`<span class="submit-spinner spinner-border"></span> ${t.innerHTML}`)})}function Xe(){document.querySelectorAll(".en__submit button").forEach(e=>{e.disabled=!1,e.querySelector(".submit-spinner")?.remove()})}function We(n="[class*='enx-']"){let e;typeof n instanceof NodeList?e=n:n instanceof HTMLElement?e=[n]:e=document.querySelectorAll(n),e.forEach(t=>{let r=t.className.split(" "),o=null;r.forEach(i=>{if(!i.includes("enx-"))return;o=o||[];let s=i.split(/[\[\]]/).filter(Boolean),d=s[0].split(":")[0],m={};for(let a=1;a<s.length;a++){let[p,v]=s[a].split("=");m[p]=v}let c=o.find(a=>a.componentName===d);c?c.attributes.push(m):o.push({componentName:d,attributes:Object.keys(m).length>0?[m]:[]})}),o&&o.forEach(i=>{let s=i.attributes.length>0?JSON.stringify(i.attributes):"";t.setAttribute(`data-${i.componentName}`,s),u(`Data attribute set "data-${i.componentName}" = ${s}`)})})}function f(n){return document.querySelectorAll(`[data-enx-${n}]`)}function _(n,e){let t=n.getAttribute(`data-enx-${e}`);if(!t)return null;try{return JSON.parse(t)}catch{return u(`Error parsing JSON "${t}" for "enx-${e}"`),[]}}function S(n,e,t){let r=_(n,e);return r&&r[0][t]||null}function I(n,e,t=null){return[...f(n)].filter(o=>{let i=_(o,n);return t?i?i.some(s=>s[e]===t):!1:i?i.some(s=>s[e]):!1})}function A(n,e,t=null){return I(n,e,t)[0]}async function ce(n=!1,e="EaDataCapture",t=""){if(!n){if(!window.pageJson)throw new Error("No campaign ID provided and no pageJson found");n=window.pageJson.campaignId}return await Ee(`https://${xe()}.engagingnetworks.app/ea-dataservice/data.service?service=${e}&campaignId=${n}&token=${t}&contentType=json`)}function be(){return window.pageJson?window.pageJson.clientId:0}function xe(){return be()>=1e4?"us":"ca"}async function Ee(n){return new Promise((e,t)=>{let r=document.createElement("script"),o="_enx_jsonp_"+Math.floor(Math.random()*1e4);n.match(/\?/)?n+="&callback="+o:n+="?callback="+o,window[o]=i=>{e(i),r.remove(),delete window[o]},r.onerror=i=>{t(i),r.remove(),delete window[o]},r.src=n,document.body.appendChild(r)})}var ye={debug:new URLSearchParams(window.location.search).has("debug"),enxCloak:!0,enxConvert:!0,enxDonate:!0,enxEmailTarget:!0,enxHtml:!0,enxModel:!0,enxMultiStepForm:!0,enxProxyFields:!0,enxReadMoreMobile:!0,enxShare:!0,enxShow:!0,enxText:!0,enxTweetTarget:!0,enxValidate:{removeErrorsOnInput:!0,sortCodeField:"supporter.bankRoutingNumber",accountNumberField:"supporter.bankAccountNumber"},enxWidget:{type:"petition",metric:"participatingSupporters",offsetCount:0,hiddenUntilCount:0,token:"ad33adbe-154d-4ac9-93c7-d60796a39b98"},beforeInit:()=>{},beforeCloakRemoval:()=>{},afterInit:()=>{}};var R=class{constructor(){this.isEnabled()&&(this.bindTargets=[...f("model")],this.bindTargets.length>0&&this.run())}isEnabled(){return ENX.getConfigValue("enxModel")!==!1}run(){let e=this.bindTargets.map(r=>_(r,"model")[0].source);[...new Set(e)].forEach(r=>{[...document.querySelectorAll(`[name="${r}"]`)].forEach(i=>{i.addEventListener("input",()=>{this.updateTargetsWithSourceValue(r)}),this.updateTargetsWithSourceValue(r)})})}updateTargetsWithSourceValue(e){I("model","source",e).forEach(r=>{r.textContent=C(e)})}};var O=class{constructor(e=[]){this.isEnabled()&&(this.proxies=[...e,...this.getProxyFieldsFromLabels()],this.proxies.length>0&&this.activateProxyFields())}isEnabled(){return ENX.getConfigValue("enxProxyFields")!==!1}getProxyFieldsFromLabels(){let e=[];return document.querySelectorAll("label").forEach(r=>{let o=r.textContent;if(o.includes("enx-proxy[")){let i=/enx-proxy\[source=(.*)]/gi.exec(o),s=document.getElementById(r.getAttribute("for"))?.getAttribute("name");i&&s&&e.push({source:i[1],target:s})}}),e}activateProxyFields(){this.proxies.forEach(e=>{let t=e.source,r=e.target;document.querySelector(`[name="${r}"]`)?.closest(".en__field")?.classList.add("enx-hidden"),document.querySelectorAll(`[name="${t}"]`).forEach(s=>{s.addEventListener("change",()=>{ee(r,C(t)),u(`Proxy field "${r}" updated with value "${C(t)}" from "${t}"`)})}),ee(r,C(t)),u(`Proxy field "${r}" updated with value "${C(t)}" from "${t}"`)})}};var V=class{constructor(){if(!this.isEnabled())return;let e=f("cloak");e&&e.forEach(t=>{t.classList.remove("enx-cloak")})}isEnabled(){return ENX.getConfigValue("enxCloak")!==!1}};var $=class{constructor(){this.isEnabled()&&this.shouldRun()&&(this.currentStep=0,this.multistepTabs=[],this.init())}init(){this.resetTabs(),this.onUrlHit(),this.onBackButton(),this.addButtonEventListeners()}isEnabled(){return ENX.getConfigValue("enxMultiStepForm")!==!1}shouldRun(){return!!document.querySelector("[class*='enx-multistep']")}resetTabs(){this.currentStep=0,this.multistepTabs=[...f("multistep")].map(e=>S(e,"multistep","name")).filter(Boolean)}onUrlHit(){let e=new URLSearchParams(window.location.search),t=A("multistep","force-start","true");if(t&&!e.has("enx-multistep-override-force")){this.changeStep(t),history.pushState(null,"","#"),this.log("URL","Show Landing page");return}if(window.location.hash){let r=location.hash.replace("#",""),o=A("multistep","name",r);if(o){this.changeStep(o),this.log("URL",'Show "'+location.hash+'"'),this.setStep(r);return}}this.changeStep(A("multistep","name"))}onBackButton(){window.onpopstate=e=>{e.state?(this.changeStep(A("multistep","name",e.state.page)),this.log("Browser",'Show "'+e.state.page+'"'),this.setStep(e.state.page)):(this.changeStep(A("multistep","name")),this.log("Browser","Show Landing page"),this.setStep(this.multistepTabs[0]))}}addButtonEventListeners(){I("multistep","destination").forEach(t=>{t.addEventListener("click",this.onButtonClick.bind(this))})}onButtonClick(e){let t=S(e.target,"multistep","destination"),r=this.multistepTabs.indexOf(t),o=!S(e.target,"multistep","no-validate")&&this.currentStep<r;if(!(this.currentStep===r||o&&r>this.currentStep+1)){if(o&&!ae()){window.dispatchEvent(new CustomEvent("enx-multistep:error",{detail:this.multistepTabs[this.currentStep].className}));return}this.changeStep(A("multistep","name",t)),this.log("App",'Show "'+t+'"'),window.dispatchEvent(new CustomEvent("enx-multistep:page-view",{detail:[{destination:t,current:this.multistepTabs[this.currentStep]}]})),this.setStep(t),t&&this.pushState(t)}}changeStep(e){this.hideAndShow(this.multistepTabs[this.currentStep],e)}hideAndShow(e,t){let r=A("multistep","name",e);r&&r.classList.remove("enx-multistep:active"),window.scrollTo({top:0,behavior:"smooth"});let o=t instanceof Element?t:document.querySelector(t);o&&o.classList.add("enx-multistep:active")}setStep(e){this.currentStep=this.multistepTabs.indexOf(e)}pushState(e){let t={page:e},r="#"+e;history.pushState(t,"",r)}log(e,t){console.log("%cSPA","color: #241C15; background-color: #FF3EBF; padding: 4px; font-weight: 400;"),console.log("Client:	",e),console.log("Action:	",t)}};var J=class{constructor(){this.isEnabled()&&(this.init(),this.legacyFunctionality())}init(){f("show").forEach(t=>{let r=S(t,"show","field"),o=S(t,"show","value"),i=document.getElementsByName(r);i.length===0&&t.classList.add("enx-hidden"),i.forEach(s=>{s.type==="radio"||s.type==="checkbox"?s.value===o&&s.checked?t.classList.remove("enx-hidden"):t.classList.add("enx-hidden"):s.value===o?t.classList.remove("enx-hidden"):t.classList.add("enx-hidden")})}),document.querySelector(".en__component--page")?.addEventListener("input",t=>{let r=t.target;r.matches("input, select, textarea")&&this.checkShowHide(r.name,r.value)})}checkShowHide(e,t){if(!e||!t)return;e==="transaction.donationAmt.other"&&(e="transaction.donationAmt"),f("show").forEach(o=>{let i=S(o,"show","field"),s=S(o,"show","value");i===e&&(s===t?(u(`showing element with class enx-show[field=${i}][value=${s}]`),o.classList.remove("enx-hidden")):(u(`hiding element with class enx-show[field=${i}][value=${s}]`),o.classList.add("enx-hidden")))})}legacyFunctionality(){this.triggerPaymentType(),this.triggerTaxDeductible(),this.triggerRecurringPayment()}showElements(e){document.querySelectorAll(e).forEach(t=>{t.classList.remove("enx-hidden")})}hideElements(e){document.querySelectorAll(e).forEach(t=>{t.classList.add("enx-hidden")})}showRecurringPayment(){if(this.hideElements('[class*="show:recurring--"]'),window.hasOwnProperty("isRegularDonorFlag")&&typeof window.isRegularDonorFlag<"u"){this.showElements(".show\\:recurring--monthly");return}let e=P("transaction.recurrpay");if(e==="Y"){this.showElements(".show\\:recurring--monthly");return}else e==="N"&&this.showElements(".show\\:recurring--single");this.showElements(".show\\:recurring--monthly-false")}triggerRecurringPayment(){this.showRecurringPayment(),document.querySelectorAll('input[type=radio][name="transaction.recurrpay"]').forEach(t=>{t.addEventListener("change",()=>{this.showRecurringPayment()})})}showTaxDeductible(){this.hideElements("[class*='show:giftaid--']");let e=P("transaction.taxdeductible");e==="Y"?this.showElements(".show\\:giftaid--Y"):e==="N"&&this.showElements(".show\\:giftaid--N")}triggerTaxDeductible(){document.querySelectorAll("input[name='transaction.taxdeductible']").forEach(e=>{e.addEventListener("change",()=>{this.showTaxDeductible()})}),setTimeout(()=>{this.showTaxDeductible()},500)}showPaymentType(){switch(this.hideElements("[class*='show:payment--']"),P("transaction.paymenttype")){case"card":this.showElements(".show\\:payment--card");break;case"paypal":this.showElements(".show\\:payment--paypal");break;case"bacs_debit":case"cash":this.showElements(".show\\:payment--directdebit");break;default:return}}triggerPaymentType(){document.querySelectorAll(".en__field--paymenttype").forEach(t=>{["DOMNodeInserted","change"].forEach(r=>{t.addEventListener(r,()=>{let o=()=>{setTimeout(()=>{this.showPaymentType()},500)};o(),document.querySelectorAll('input[type=radio][name="transaction.paymenttype"]').forEach(function(s){s.addEventListener("change",o)})})})}),document.querySelectorAll('input[type=radio][name="transaction.paymenttype"]').forEach(t=>{t.addEventListener("change",()=>{this.showPaymentType()})}),setTimeout(()=>{this.showPaymentType()},500)}isEnabled(){return ENX.getConfigValue("enxShow")!==!1}};var H=class{constructor(){this.isEnabled()&&(this.svgUrl="https://storage.c6-digital.net/en-components/img/share-icons/",this.shareLabels={en:"Share on",fr:"Partager sur",de:"Teilen auf",es:"Compartir en",it:"Condividi su"},this.customShareSettings={facebook:{url:"https://www.facebook.com/sharer/sharer.php?u=",msgSelector:"[class*='enx-share:facebook-link']",btnSelector:"[class*='enx-share:facebook-button']"},twitter:{url:"https://twitter.com/intent/tweet?text=",msgSelector:"[class*='enx-share:twitter-msg']",btnSelector:"[class*='enx-share:twitter-button']"},whatsapp:{url:"https://api.whatsapp.com/send?text=",msgSelector:"[class*='enx-share:whatsapp-msg']",btnSelector:"[class*='enx-share:whatsapp-button']"},email:{subjectUrl:"mailto:?subject=",subjectSelector:"[class*='enx-share:email-subject']",bodyUrl:"&body=",bodySelector:"[class*='enx-share:email-body']",btnSelector:"[class*='enx-share:email-button']"}},this.makeShareButtons(),this.setupSharePreview(),this.hasNativeShareLink()&&this.addNativeShareElement(),this.updateShareLinks())}makeShareButtons(){let e=document.querySelectorAll(".en__socialShare");e.length>0&&e.forEach(t=>{let r=t.getAttribute("data-enshare");t.removeAttribute("style"),t.classList.add("enx-share-link");let o=this.shareLabels[M()]||this.shareLabels.en;t.innerText=`${o} ${r.charAt(0).toUpperCase()+r.slice(1)}`;let i=document.createElement("img");i.classList.add("enx-share-icon"),i.setAttribute("src",this.svgUrl+r+".svg"),t.appendChild(i)})}setupSharePreview(){document.querySelector(".share-preview-image")?.setAttribute("src",document.querySelector("meta[property='og:image']").getAttribute("content")),document.querySelector(".share-preview-title")?.setAttribute("src",document.querySelector("meta[property='og:title']").getAttribute("content")),document.querySelector(".share-preview-description")?.setAttribute("src",document.querySelector("meta[property='og:description']").getAttribute("content")),document.querySelector(".share-preview-link")?.setAttribute("href",document.querySelector(".en__socialShare--facebook").getAttribute("href"))}hasNativeShareLink(){return!!document.querySelector("[class*='enx-share:native-link']")}addNativeShareElement(){let e=document.querySelector("[class*='enx-share:native-link']"),t=document.querySelector("[class*='enx-share:native-title']"),r=document.querySelector("[class*='enx-share:native-description']");if("navigator"in window&&"share"in window.navigator){let o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("aria-label","Share"),o.classList.add("enx-share:native-button"),o.textContent="Share",e.appendChild(o),o.addEventListener("click",()=>{let i={url:e.querySelector("p").textContent.trim()};t&&(i.title=t.textContent.trim()),r&&(i.text=r.textContent.trim()),window.navigator.share(i)})}else{let o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("aria-label","Copy"),o.classList.add("enx-share:native-button"),o.textContent="Copy",e.appendChild(o),o.addEventListener("click",()=>{let i=document.createRange();i.selectNode(e.querySelector("p")),window.getSelection().removeAllRanges(),window.getSelection().addRange(i),document.execCommand("copy"),window.getSelection().removeAllRanges(),o.textContent="Copied!",o.setAttribute("disabled","disabled"),setTimeout(()=>{o.textContent="Copy",o.removeAttribute("disabled")},2e3)})}}updateShareLinks(){["facebook","twitter","whatsapp","email"].forEach(e=>{let t=this.customShareSettings[e],r=document.querySelector(t.btnSelector);if(r)if(e==="email"){let o=document.querySelector(t.subjectSelector)?.textContent.trim(),i=document.querySelector(t.bodySelector)?.textContent.trim();r.setAttribute("href",t.subjectUrl+encodeURIComponent(o)+t.bodyUrl+encodeURIComponent(i))}else{let o=document.querySelector(t.msgSelector)?.textContent.trim();r.setAttribute("href",t.url+encodeURIComponent(o))}})}isEnabled(){return ENX.getConfigValue("enxShare")!==!1}};var U=class{constructor(){this.isEnabled()&&(this.readMoreSections=f("read-more-mobile"),this.readMoreSections.length>0&&this.addReadMoreSections())}addReadMoreSections(){this.readMoreSections.forEach(e=>{let t=S(e,"read-more-mobile","visible")??2,r=[...e.children].slice(t),o=document.createElement("div");o.className="enx-read-more:content-mobile",r.forEach(i=>{o.appendChild(i)}),e.appendChild(o),o.insertAdjacentHTML("beforebegin",`<a style="text-decoration: none; cursor: pointer;" class="enx-read-more:toggle">
          Read more
          <svg
            class="rm-icon-normal ml-2"
            width="15"
            height="15"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <svg
            class="rm-icon-expanded ml-2"
            width="15"
            height="15"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
        </a>`)}),document.querySelectorAll(".enx-read-more\\:toggle").forEach(e=>{e.addEventListener("click",()=>{e.closest('[class*="enx-read-more-mobile"]').classList.toggle("enx-read-more-mobile:open")})})}isEnabled(){return ENX.getConfigValue("enxReadMoreMobile")!==!1}};var X=class{constructor(){this.isEnabled()&&this.run()}run(){let e=f("text");e.length>0&&e.forEach(t=>{let r=_(t,"text");r&&r.forEach(o=>{let i=document.querySelector(`.${o.source}`);i&&(t.textContent=i.textContent)})})}isEnabled(){return ENX.getConfigValue("enxText")!==!1}};var W=class{constructor(){this.isEnabled()&&this.run()}run(){let e=f("html");e.length>0&&e.forEach(t=>{let r=_(t,"html");r&&r.forEach(o=>{let i=document.querySelector(`.${o.source}`);i&&(t.innerHTML=i.innerHTML)})})}isEnabled(){return ENX.getConfigValue("enxHtml")!==!1}};var j=class{constructor(){this.isEnabled()&&this.addPhotoOfMP()}addPhotoOfMP(){let e=document.querySelectorAll("img[data-mp-location][data-mp-name]");e.length!==0&&e.forEach(async t=>{t.src=await B(t.dataset.mpName,t.dataset.mpLocation)})}isEnabled(){return ENX.getConfigValue("enxEmailTarget")!==!1}};var z=class{constructor(){if(!this.isEnabled()||!this.shouldRun())return;this.currentTweet=0,this.tweetTextarea=document.querySelector(".en__tweet textarea"),this.tweets=[];let e=[...f("tweet-target")].find(s=>!s.classList.contains("enx-tweet-target:custom-tweets"));if(!e){u("No tweet target main element found, not running TweetTarget");return}let t={"custom-tweets":!0,"mp-photo":!0,"hide-background-tab":!0,"hide-sent-btn":!0,"show-target-profile":!0,"redirect-on-tweet":!0},r=_(e,"tweet-target"),o=r?r[0]:{},i={...t,...o};i["custom-tweets"]===!0&&this.customTweets(),i["mp-photo"]===!0&&this.setMPPhoto(),i["hide-background-tab"]===!0&&this.hideBackgroundTab(),i["hide-sent-btn"]===!0&&this.hideSentBtn(),i["show-target-profile"]!==!0&&this.hideTargetProfile(),i["redirect-on-tweet"]===!0&&this.redirectOnTweet()}redirectOnTweet(){document.querySelector(".en__tweetButton__send > a").addEventListener("click",()=>{setTimeout(()=>{window.location.href=te()},0)})}hideTargetProfile(){let e=document.querySelector(".en__twitterTarget");e.style.display="none"}hideBackgroundTab(){let e=document.querySelector(".en__tweetBackgroundToggle");e.style.display="none";let t=document.querySelector(".en__tweetBackgroundText");t.style.display="none"}hideSentBtn(){let e=document.querySelector(".en__tweetButton__sent");e.style.display="none"}async setMPPhoto(){let e=JSON.parse(document.querySelector(".en__tweetBackgroundText").textContent),t=document.querySelector(".en__twitterTarget__image");t.src=await B(e.name,e.location)}customTweets(){if(document.querySelectorAll("[class*='enx-tweet-target:custom-tweets'] .en__component--copyblock").length===0){u("No custom tweets found, not running customTweets");return}this.getCustomTweets(),this.addNewTweetBtn()}getCustomTweets(){let e=document.querySelector(".en__twitterTarget__handle").textContent,t=[...document.querySelectorAll("[class*='enx-tweet-target:custom-tweets'] .en__component--copyblock, .en__tweet textarea")].map(r=>r.textContent.replace("{twitter_handle}",e).trim());this.tweets=le(t)}addNewTweetBtn(){document.head.insertAdjacentHTML("beforeend",`<style>
        .en__tweet {
          position: relative;
        }

        .en__tweet textarea {
          padding-top: 35px;
        }

        .enx-tweet-target\\:new-tweet-btn {
          background-color: transparent;
          border: none;
          padding: 0;
          position: absolute;
          top: 20px;
          right: 20px;
          width: 24px;
          height: 24px;
          color: rgb(55 65 81);
        }

        .spin {
          animation: spin 0.5s ease-in-out;
        }
        
        .en__tweetButton--sent .en__tweetButton__send {
          display: inline-block;
        }

        @keyframes spin {
          0% {
            transform: rotate(0deg);
          }
          100% {
            transform: rotate(360deg);
          }
        }
      </style>
      `);let e=document.querySelector(".en__tweet"),t='<button class="enx-tweet-target:new-tweet-btn" type="button"><svg fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z" clip-rule="evenodd"></path></svg></button>';e.insertAdjacentHTML("beforeend",t);let r=document.querySelector(".en__tweet > [class*='enx-tweet-target:new-tweet-btn']"),o=r.querySelector("svg");r.addEventListener("click",()=>{o.classList.add("spin"),setTimeout(()=>{o.classList.remove("spin")},500),this.currentTweet>=this.tweets.length&&(this.currentTweet=0),this.tweetTextarea.value=this.tweets[this.currentTweet],this.currentTweet++})}shouldRun(){return!!document.querySelector("[class*='enx-tweet-target']")}isEnabled(){return ENX.getConfigValue("enxTweetTarget")!==!1}};var Y=class{constructor(){this.isEnabled()&&(this.removeEmptyDecimalFromTotalAmountSpans(),this.addCurrencyToDonationOther())}removeEmptyDecimalFromTotalAmountSpans(){let e=document.querySelector('span[data-token="amount-total"]');if(!e)return;let t=()=>{let o=".";window.pageJson&&window.pageJson.locale&&(o=1.1.toLocaleString(M()).substring(1,2)),document.querySelectorAll('span[data-token="amount-total"]').forEach(i=>{i.textContent=i.textContent.replace(o+"00","")})};t(),new MutationObserver(t).observe(e,{subtree:!0,childList:!0})}addCurrencyToDonationOther(){document.querySelector(".en__field--donationAmt .en__field__item--other")?.classList.add("amount-currency--"+ne())}isEnabled(){return ENX.getConfigValue("enxDonate")!==!1}};var b,x,l,_e=function(n){return n.replace(/[^\d]/g,"")},je=function(n){return n.reduce(function(e,t){return e+t},0)},ze=function(n,e){return n.slice(0,e)},me=function(n){var e=n.value;return n.delimiters.forEach(function(t){t.split("").forEach(function(r){e=e.replace(new RegExp(r.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g"),"")})}),e},Ae=function(n){var e=n.blocks,t=n.delimiter,r=t===void 0?"":t,o=n.delimiters,i=o===void 0?[]:o,s=n.delimiterLazyShow,d=s!==void 0&&s,m="",c=n.value,a="";return e.forEach(function(p,v){if(c.length>0){var h,E=c.slice(0,p),w=c.slice(p);a=i.length>0?(h=i[d?v-1:v])!=null?h:a:r,d?(v>0&&(m+=a),m+=E):(m+=E,E.length===p&&v<e.length-1&&(m+=a)),c=w}}),m},pe=function(n){var e=n.delimiter,t=n.delimiters,r=n.prefix,o=r===void 0?"":r,i=n.input;if(i.CLEAVE_ZEN_cursor_tracker!==void 0)return function(){i.removeEventListener("input",i.CLEAVE_ZEN_cursor_tracker),i.CLEAVE_ZEN_cursor_tracker=void 0};var s=[e===void 0?"":e].concat(t===void 0?[]:t);return i.CLEAVE_ZEN_cursor_tracker=function(d){var m,c=d.target;(d.inputType==="deleteContentBackward"||c.value.length!==c.selectionEnd)&&(c.CLEAVE_ZEN_cleanCursorIndex=function(a){for(var p=a.value,v=a.dirtyCursorIndex,h=a.delimiters,E=v,w=0;w<v;w++)h.includes(p[w])&&E--;return E}({value:c.value,dirtyCursorIndex:(m=c.selectionEnd)!=null?m:0,delimiters:s}),setTimeout(function(){var a;if(me({value:c.value,delimiters:s})!==o){var p=function(v){for(var h=v.value,E=v.delimiters,w=v.cleanCursorIndex,g=0;g<h.length&&(E.includes(h[g])&&w++,g!==w-1);g++);return w}({value:c.value,cleanCursorIndex:(a=c.CLEAVE_ZEN_cleanCursorIndex)!=null?a:0,delimiters:s});c.setSelectionRange(p,p)}},0))},i.addEventListener("input",i.CLEAVE_ZEN_cursor_tracker),function(){i.removeEventListener("input",i.CLEAVE_ZEN_cursor_tracker),i.CLEAVE_ZEN_cursor_tracker=void 0}},re=function(n,e){var t=e.blocks,r=e.delimiter,o=r===void 0?"":r,i=e.delimiters,s=i===void 0?[]:i,d=e.delimiterLazyShow,m=d!==void 0&&d,c=e.prefix,a=c===void 0?"":c,p=e.numericOnly,v=p!==void 0&&p,h=e.uppercase,E=h!==void 0&&h,w=e.lowercase,g=w!==void 0&&w;return o.length>0&&s.push(o),n=function(N){var y=N.value,T=N.prefix,F=N.tailPrefix,k=T.length;return k===0?y:y===T&&y!==""?"":y.slice(0,k)===T||F?y.slice(-k)!==T&&F?"":F?y.slice(0,-k):y.slice(k):""}({value:n=me({value:n,delimiters:s}),prefix:a,tailPrefix:!1}),n=v?_e(n):n,n=E?n.toUpperCase():n,n=g?n.toLowerCase():n,a.length>0&&(n=a+n),Ae({value:n,blocks:t,delimiter:o,delimiters:s,delimiterLazyShow:m})};var Te=" ";(function(n){n.UATP="uatp",n.AMEX="amex",n.DINERS="diners",n.DISCOVER="discover",n.MASTERCARD="mastercard",n.DANKORT="dankort",n.INSTAPAYMENT="instapayment",n.JCB15="jcb15",n.JCB="jcb",n.MAESTRO="maestro",n.VISA="visa",n.MIR="mir",n.UNIONPAY="unionpay",n.GENERAL="general"})(l||(l={}));var D,de=((b={})[l.UATP]=[4,5,6],b[l.AMEX]=[4,6,5],b[l.DINERS]=[4,6,4],b[l.DISCOVER]=[4,4,4,4],b[l.MASTERCARD]=[4,4,4,4],b[l.DANKORT]=[4,4,4,4],b[l.INSTAPAYMENT]=[4,4,4,4],b[l.JCB15]=[4,6,5],b[l.JCB]=[4,4,4,4],b[l.MAESTRO]=[4,4,4,4],b[l.VISA]=[4,4,4,4],b[l.MIR]=[4,4,4,4],b[l.UNIONPAY]=[4,4,4,4],b[l.GENERAL]=[4,4,4,4],b),Se=((x={})[l.UATP]=/^(?!1800)1\d{0,14}/,x[l.AMEX]=/^3[47]\d{0,13}/,x[l.DISCOVER]=/^(?:6011|65\d{0,2}|64[4-9]\d?)\d{0,12}/,x[l.DINERS]=/^3(?:0([0-5]|9)|[689]\d?)\d{0,11}/,x[l.MASTERCARD]=/^(5[1-5]\d{0,2}|22[2-9]\d{0,1}|2[3-7]\d{0,2})\d{0,12}/,x[l.DANKORT]=/^(5019|4175|4571)\d{0,12}/,x[l.INSTAPAYMENT]=/^63[7-9]\d{0,13}/,x[l.JCB15]=/^(?:2131|1800)\d{0,11}/,x[l.JCB]=/^(?:35\d{0,2})\d{0,12}/,x[l.MAESTRO]=/^(?:5[0678]\d{0,2}|6304|67\d{0,2})\d{0,12}/,x[l.MIR]=/^220[0-4]\d{0,12}/,x[l.VISA]=/^4\d{0,15}/,x[l.UNIONPAY]=/^(62|81)\d{0,14}/,x),Ce=function(n){var e=n.reduce(function(t,r){return t+r},0);return n.concat(19-e)},Ye=function(n){for(var e=n.value,t=n.strictMode,r=0,o=Object.keys(Se);r<o.length;r++){var i=o[r];if(Se[i].test(e)){var s=de[i];return{type:i,blocks:t!=null&&t?Ce(s):s}}}return{type:l.GENERAL,blocks:t!=null&&t?Ce(de.general):de.general}},ke=function(n,e){var t=e??{},r=t.delimiter,o=r===void 0?" ":r,i=t.delimiterLazyShow,s=i!==void 0&&i,d=t.strictMode,m=d!==void 0&&d;n=_e(n),n=me({value:n,delimiters:[o]});var c=Ye({value:n,strictMode:m}).blocks,a=je(c);return n=ze(n,a),Ae({value:n,blocks:c,delimiter:o,delimiterLazyShow:s})};(function(n){n.THOUSAND="thousand",n.LAKH="lakh",n.WAN="wan",n.NONE="none"})(D||(D={}));var Ze=D.THOUSAND,Ne=function(n,e){var t=e??{},r=t.delimiter,o=t.numeralThousandsGroupStyle,i=t.numeralIntegerScale,s=t.numeralDecimalMark,d=t.numeralDecimalScale,m=t.stripLeadingZeroes,c=t.numeralPositiveOnly,a=t.tailPrefix,p=t.signBeforePrefix,v=t.prefix;return function(h){var E,w,g,N=h.delimiter,y=h.numeralDecimalMark,T=h.numeralDecimalScale,F=h.stripLeadingZeroes,k=h.numeralPositiveOnly,he=h.numeralIntegerScale,Le=h.numeralThousandsGroupStyle,Pe=h.signBeforePrefix,Me=h.tailPrefix,ie=h.prefix,se="",L=h.value.replace(/[A-Za-z]/g,"").replace(y,"M").replace(/[^\dM-]/g,"").replace(/^-/,"N").replace(/-/g,"").replace("N",k!=null&&k?"":"-").replace("M",y);F&&(L=L.replace(/^(-)?0+(?=\d)/,"$1"));var Q=L.slice(0,1)==="-"?"-":"";switch(w=Pe?Q+ie:ie+Q,g=L,L.includes(y)&&(g=(E=L.split(y))[0],se=y+E[1].slice(0,T)),Q==="-"&&(g=g.slice(1)),he>0&&(g=g.slice(0,he)),Le){case D.LAKH:g=g.replace(/(\d)(?=(\d\d)+\d$)/g,"$1"+N);break;case D.WAN:g=g.replace(/(\d)(?=(\d{4})+$)/g,"$1"+N);break;case D.THOUSAND:g=g.replace(/(\d)(?=(\d{3})+$)/g,"$1"+N)}return Me?Q+g+(T>0?se:"")+ie:w+g+(T>0?se:"")}({value:n,delimiter:r===void 0?",":r,numeralIntegerScale:i===void 0?0:i,numeralDecimalMark:s===void 0?".":s,numeralDecimalScale:d===void 0?2:d,stripLeadingZeroes:m===void 0||m,numeralPositiveOnly:c!==void 0&&c,numeralThousandsGroupStyle:o===void 0?Ze:o,tailPrefix:a!==void 0&&a,signBeforePrefix:p!==void 0&&p,prefix:v===void 0?"":v})};var Z=class{constructor(e=!1){this.isEnabled()&&(this.config=e,this.email(),this.creditCard(),this.cvv(),this.sortCode(this.config.sortCodeField),this.accountNumber(this.config.accountNumberField),this.amountOther(),this.noSpaces('enx-validate[rule="no-spaces"]'),this.config.removeErrorsOnInput&&this.removeErrorsOnInput())}isEnabled(){return ENX.getConfigValue("enxValidate")!==!1}email(e="#en__field_supporter_emailAddress"){this.noSpaces(e)}creditCard(e="#en__field_transaction_ccnumber"){let t=document.querySelector(e);t&&(pe({input:t,delimiter:Te}),t.addEventListener("input",r=>{let o=r.target.value;t.value=ke(o),u(`Credit Card: ${o}, formatted to: ${t.value}`)}))}cvv(e="#en__field_transaction_ccvv"){let t=document.querySelector(e);t?.addEventListener("input",r=>{let o=r.target.value;t.value=re(o,{numericOnly:!0,blocks:[4]}),u(`CVV: ${o}, formatted to: ${t.value}`)})}sortCode(e){let t=document.getElementsByName(e)[0];t&&(pe({input:t,delimiter:"-"}),t.addEventListener("input",r=>{let o=r.target.value;t.value=re(o,{delimiter:"-",blocks:[2,2,2],numericOnly:!0}),u(`Sort Code: ${o}, formatted to: ${t.value}`)}))}accountNumber(e){let t=document.getElementsByName(e)[0];t&&t.addEventListener("input",r=>{let o=r.target.value;t.value=re(o,{blocks:[8],numericOnly:!0}),u(`Account Number: ${o}, formatted to: ${t.value}`)})}amountOther(e="transaction.donationAmt.other"){let t=document.getElementsByName(e)[0];t&&t.addEventListener("input",r=>{let o=r.target.value;t.value=Ne(o,{numeralThousandsGroupStyle:"none"}),u(`Amount Other: ${o}, formatted to: ${t.value}`)})}noSpaces(e=""){document.querySelectorAll(e).forEach(r=>{r.addEventListener("input",()=>{r.value=r.value.replace(/\s+/g,"")})})}removeErrorsOnInput(){document.querySelectorAll("input, select, textarea").forEach(t=>{t.addEventListener("input",r=>{let o=r.target.closest(".en__field");if(o?.classList.contains("en__field--validationFailed")){o.classList.remove("en__field--validationFailed");let s=o.querySelector(".en__field__error");s&&(s.style.display="none")}})})}};var G=class{constructor(){if(this.isEnabled()){if(!window.pageJson)return u("No pageJson found, not running ENXConvert"),!1;if(this.pages=this.getPagesLog(),this.previousPage=this.pages[this.pages.length-1]||null,this.currentPage=new oe(window.pageJson),this.updatePagesLog(),!(this.hasAlreadyConverted()||window.hasOwnProperty("ENConversion_DontConvert")&&window.ENConversion_DontConvert===!0)){if(window.hasOwnProperty("ENConversion_Convert")&&window.ENConversion_Convert===!0){this.convert();return}this.checkForConversion()}}}checkForConversion(){this.currentPage.isLastPage()&&this.currentPage.hasMoreThanOnePage()&&!this.currentPage.hasRedirect()?this.convert():this.currentPage.isSinglePage()&&this.currentPage.hasRedirect()&&this.convert()}convert(){sessionStorage.setItem("ENConversion_Converted_"+this.currentPage.pageJson.campaignId,"true"),u("ENXConvert: Converted"),this.dispatchEvents()}dispatchEvents=function(){let e;switch(this.currentPage.pageJson.pageType){case"donation":case"premiumgift":case"e-commerce":e="donation";break;default:e="submission";break}let t=new Event("synthetic-en:conversion",{bubbles:!0}),r=new Event("synthetic-en:conversion:"+this.currentPage.pageJson.pageType,{bubbles:!0}),o=new Event("synthetic-en:conversion:group:"+e,{bubbles:!0});dispatchEvent(t),dispatchEvent(r),dispatchEvent(o)};hasAlreadyConverted(){return sessionStorage.getItem("ENConversion_Converted_"+this.currentPage.pageJson.campaignId)!==null}getPagesLog(){let e=JSON.parse(sessionStorage.getItem("ENConversion_PagesLog"));return e===null?[]:e.map(function(t){return new oe(t)})}updatePagesLog(){let e=JSON.parse(sessionStorage.getItem("ENConversion_PagesLog"));e===null?sessionStorage.setItem("ENConversion_PagesLog",JSON.stringify([this.currentPage.pageJson])):(this.currentPage.isSamePageAs(this.previousPage)||e.push(this.currentPage.pageJson),sessionStorage.setItem("ENConversion_PagesLog",JSON.stringify(e)))}isEnabled(){return ENX.getConfigValue("enxConvert")!==!1}},oe=class{constructor(e){this.pageJson=e}isLastPage(){return this.pageJson.pageNumber===this.pageJson.pageCount}hasMoreThanOnePage(){return this.pageJson.pageCount>1}isSinglePage(){return this.pageJson.pageCount===1}hasRedirect(){return this.pageJson.redirectPresent}hasPagesLeft(){return this.pageJson.pageNumber<this.pageJson.pageCount}isSamePageAs(e){return this.pageJson.campaignPageId===e.pageJson.campaignPageId&&this.pageJson.pageNumber===e.pageJson.pageNumber}};var K=class{constructor(e){this.isEnabled()&&(this.config=typeof e=="object"?e:{},this.setupEnProgressBarWidget())}isEnabled(){return ENX.getConfigValue("enxWidget")!==!1}async setupEnProgressBarWidget(){let e=document.querySelector(".enWidget.enWidget--progressBar"),t=document.querySelector(".signature-counter");if(!e&&!t){u("ENXWidget: No progress bar or counter text found, skipping widget setup");return}e?.classList.add("enx-hidden"),t?.classList.add("enx-hidden");let r=window.pageJson&&window.pageJson.campaignId,o=this.config.type==="petition"?"EaDataCapture":"FundraisingSummary",i=await ce(r,o,this.config.token);if(!i||!i.rows){u("ENXWidget: No API response found, skipping widget setup");return}let s=i.rows[0].columns.find(p=>p.name===this.config.metric).value,d=parseInt(s||0)+this.config.offsetCount;if(!d){u("ENXWidget: No total count found in API response, skipping widget setup");return}if(this.config.hiddenUntilCount&&this.config.hiddenUntilCount>d){u(`ENXWidget: Total count ${d} is less than hiddenUntilCount, skipping widget setup`);return}let m=this.getTarget(d),c=m-d,a=(d*100/m).toFixed(0)+"%";if(t&&(t.innerHTML=t.innerHTML.replace("{signature.remaining}",c.toLocaleString()).replace("{signature.percent}",a).replace("{signature.count}",d.toLocaleString()).replace("{signature.target}",m.toLocaleString()),t.classList.remove("enx-hidden")),e){let p=e.querySelector(".enWidget__fill");p&&(p.style.width="0%",p.style.height="100%",e.classList.remove("enx-hidden"),p.style.width=a,e.classList.remove("enx-hidden"))}u(`ENXWidget: ${d} signatures, ${m} target, ${c} remaining, ${a} complete`)}getTarget(e){let t=parseInt(e)*1.05,r=Math.ceil(t/5e5)*5e5;return t<15e3?r=Math.ceil(t/5e3)*5e3:t<5e4?r=Math.ceil(t/1e4)*1e4:t<2e5?r=Math.ceil(t/5e4)*5e4:t<5e5&&(r=Math.ceil(t/1e5)*1e5),r}};var q=class{constructor(e={}){this.config={...ye,...e},window.hasOwnProperty("ENXPageConfig")&&(this.config={...this.config,...window.ENXPageConfig}),window.ENXConfig=this.config,this.config.beforeInit(),this.waitForEnDefaults().then(()=>{this.enxHelpers=ue,this.enxHelpers.transformEnxClassesToDataAttributes(),this.enxModel=new R,this.enxProxyFields=new O(this.config.proxies),this.enxMultiStepForm=new $,this.enxShow=new J,this.enxShare=new H,this.enxReadMoreMobile=new U,this.enxText=new X,this.enxHtml=new W,this.enxEmailTarget=new j,this.enxTweetTarget=new z,this.enxDonate=new Y,this.enxValidate=new Z(this.config.validate),this.enxConvert=new G,this.enxWidget=new K(this.config.enxWidget),this.config.beforeCloakRemoval(),this.cloak=new V,this.config.afterInit()})}waitForEnDefaults(){return new Promise(e=>{function t(){window.EngagingNetworks.require._defined.enDefaults!==void 0?e():setTimeout(t,50)}t()})}static getConfigValue(e){return window.ENXConfig.hasOwnProperty(e)?window.ENXConfig[e]:null}};window.ENX=q;var Kt=q;})();
