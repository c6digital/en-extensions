(()=>{var q=Object.defineProperty;var A=(o,e)=>{for(var t in e)q(o,t,{get:e[t],enumerable:!0})};var x={};A(x,{getENFieldValue:()=>w,getENSupporterData:()=>a,getENValidators:()=>S,getVisibleValidators:()=>E,setENFieldValue:()=>f,validateVisibleFields:()=>y});function w(o,e=!0){let t=window.EngagingNetworks.require._defined.enDefaults.getFieldValue(o);if(t)return t;if(e)return a(o)}function a(o){return window.EngagingNetworks.require._defined.enDefaults.getSupporterData(o)}function f(o,e){window.EngagingNetworks.require._defined.enDefaults.setFieldValue(o,e)}function S(){return window.EngagingNetworks.require._defined.enValidation.validation.validators}function E(){return S().filter(o=>!!document.querySelector(".enx-multistep-active .en__field--"+o.field))}function y(){return E().map(e=>(e.hideMessage(),!e.isVisible()||e.test())).every(e=>e)}var c=class{constructor(){this.bindTargets=[...document.querySelectorAll("[class*='enx-model:']")],this.shouldRun()&&this.run()}shouldRun(){return this.bindTargets.length>0}run(){let e=this.bindTargets.map(n=>n.classList.value.split("enx-model:")[1].split(" ")[0]);[...new Set(e)].forEach(n=>{[...document.querySelectorAll(`[name="${n}"]`)].forEach(i=>{i.addEventListener("change",()=>{let r=CSS.escape(`enx-model:${n}`),b=[...document.querySelectorAll(`.${r}`)],v=w(n.split(".")[1]);b.forEach(C=>{C.textContent=v})})})})}};var u=class{constructor(e=[]){this.proxies=e,this.shouldRun()&&this.activateProxyFields()}shouldRun(){return this.proxies.length>0}activateProxyFields(){this.proxies.forEach(e=>{let t=e.source.split(".")[1],n=e.target.split(".")[1];document.querySelectorAll(`[name="${e.source}"]`).forEach(s=>{s.addEventListener("change",()=>{f(n,a(t))})}),f(n,a(t))})}};var d=class{constructor(){document.querySelectorAll(".enx-cloak").forEach(e=>{e.classList.remove("enx-cloak")})}};var h=class{constructor(){this.currentStep=0,this.multistepTabs=[],this.shouldRun()&&this.init()}init(){this.resetTabs(),this.onUrlHit(),this.onBackButton(),this.onClick()}shouldRun(){return!!document.querySelector(".enx-multistep")}resetTabs(){this.currentStep=0;let e=[...document.querySelectorAll(".enx-multistep[class*='enx-multistep-name--']")].map(t=>t.className.match(/enx-multistep-name--[a-z]*/gi)[0].replace("enx-multistep-name--",""));this.multistepTabs=[...new Set(e)]}onUrlHit(){let e=new URLSearchParams(location.href);if(document.querySelectorAll(".enx-multistep-force-start").length&&!e.has("override-force-multistep")){this.changeStep(".enx-multistep-force-start"),history.pushState(null,"","#"),this.log("URL","Show Landing page");return}if(window.location.hash){let t=location.hash.replace("#","");document.querySelectorAll(".enx-multistep-name--"+t).length?(this.changeStep(".enx-multistep-name--"+t),this.log("URL",'Show "'+location.hash+'"'),this.setStep(t)):[...document.querySelectorAll(".enx-multistep")].some(s=>s.className.match(/show:/))?window.location=window.location.href.split("#")[0]:this.changeStep(document.querySelector(".enx-multistep"));return}this.changeStep(document.querySelector(".enx-multistep"))}onBackButton(){window.onpopstate=e=>{e.state?(this.changeStep(".enx-multistep-name--"+e.state.page),this.log("Browser",'Show "'+e.state.page+'"'),this.setStep(e.state.page)):[...document.querySelectorAll(".enx-multistep")].some(n=>n.className.match(/show:/))?location.reload():(this.changeStep(".enx-multistep"),this.log("Browser","Show Landing page"),this.setStep(this.multistepTabs[0]))}}onClick(){document.querySelectorAll("[enx-multistep-destination]").forEach(t=>{t.addEventListener("click",n=>{let s=n.target.getAttribute("enx-multistep-destination"),i=this.multistepTabs.indexOf(s),r=!n.target.hasAttribute("no-validate")&&this.currentStep<i;if(!(this.currentStep===i||r&&i>this.currentStep+1)){if(r&&!y()){window.dispatchEvent(new CustomEvent("onEnxMultistepError",{detail:this.multistepTabs[this.currentStep].className}));return}this.changeStep(".enx-multistep-name--"+s),this.log("App",'Show "'+s+'"'),window.dispatchEvent(new CustomEvent("enx-multistep:page-view",{detail:[{destination:s,current:this.multistepTabs[this.currentStep]}]})),this.setStep(s),s&&this.pushState(s)}})})}changeStep(e){this.hideAndShow(this.multistepTabs[this.currentStep],e)}hideAndShow(e,t){let n=document.querySelector(`.enx-multistep-name--${e}`);n&&n.classList.remove("enx-multistep-active"),window.scrollTo({top:0,behavior:"smooth"});let s=t instanceof Element?t:document.querySelector(t);s&&s.classList.add("enx-multistep-active")}setStep(e){this.currentStep=this.multistepTabs.indexOf(e)}pushState(e){let t={page:e},n="#"+e;history.pushState(t,"",n)}log(e,t){console.log("%cSPA","color: #241C15; background-color: #FF3EBF; padding: 4px; font-weight: 400;"),console.log("Client:	",e),console.log("Action:	",t)}moveToFirstFailedSpa(){let e=document.querySelector(".en__field--validationFailed"),t=e&&e.closest(".enx-multistep");if(!t)return;let n=Array.from(t.classList).find(s=>s.includes("enx-multistep-name--"));n&&this.changeStep("."+n)}};var m=class{constructor(){this.init(),this.legacyFunctionality()}init(){document.querySelectorAll('[class*="enx-show:"]').forEach(e=>{let t=this.getConditionalClassFromElement(e),n=this.getMatchDetailsFromClass(t);if(!n)return;let s=document.getElementsByName(n.fieldName);s.length===0&&e.classList.add("enx-hidden"),s.forEach(i=>{i.type==="radio"||i.type==="checkbox"?i.value===n.fieldValue&&i.checked?e.classList.remove("enx-hidden"):e.classList.add("enx-hidden"):i.value===n.fieldValue?e.classList.remove("enx-hidden"):e.classList.add("enx-hidden")})}),document.querySelector(".en__component--page")?.addEventListener("input",e=>{let t=e.target;t.matches("input, select, textarea")&&this.checkShowHide(t.name,t.value)})}checkShowHide(e,t){if(!e||!t)return;e==="transaction.donationAmt.other"&&(e="transaction.donationAmt"),document.querySelectorAll('[class*="enx-show:"]').forEach(s=>{let i=this.getConditionalClassFromElement(s),r=this.getMatchDetailsFromClass(i);!r||r.fieldName!==e||(r.fieldValue===t?s.classList.remove("enx-hidden"):s.classList.add("enx-hidden"))})}getConditionalClassFromElement(e){return e.className.split(" ").find(t=>t.includes("enx-show:"))}getMatchDetailsFromClass(e){let n=/enx-show:([^[]+)\[([^[]+)]/g.exec(e);return n?{fieldName:n[1],fieldValue:n[2]}:null}legacyFunctionality(){this.triggerPaymentType(),this.triggerTaxDeductible(),this.triggerRecurringPayment()}showElements(e){document.querySelectorAll(e).forEach(t=>{t.classList.remove("enx-hidden")})}hideElements(e){document.querySelectorAll(e).forEach(t=>{t.classList.add("enx-hidden")})}showRecurringPayment(){if(this.hideElements('[class*="show:recurring--"]'),window.hasOwnProperty("isRegularDonorFlag")&&typeof window.isRegularDonorFlag<"u"){this.showElements(".show\\:recurring--monthly");return}let e=a("recurrpay");if(e==="Y"){this.showElements(".show\\:recurring--monthly");return}else e==="N"&&this.showElements(".show\\:recurring--single");this.showElements(".show\\:recurring--monthly-false")}triggerRecurringPayment(){this.showRecurringPayment(),document.querySelectorAll('input[type=radio][name="transaction.recurrpay"]').forEach(t=>{t.addEventListener("change",()=>{this.showRecurringPayment()})})}showTaxDeductible(){this.hideElements("[class*='show:giftaid--']");let e=a("taxdeductible");e==="Y"?this.showElements(".show\\:giftaid--Y"):e==="N"&&this.showElements(".show\\:giftaid--N")}triggerTaxDeductible(){document.querySelectorAll("input[name='transaction.taxdeductible']").forEach(e=>{e.addEventListener("change",()=>{this.showTaxDeductible()})}),setTimeout(()=>{this.showTaxDeductible()},500)}showPaymentType(){switch(this.hideElements("[class*='show:payment--']"),a("paymenttype")){case"card":this.showElements(".show\\:payment--card");break;case"paypal":this.showElements(".show\\:payment--paypal");break;case"bacs_debit":case"cash":this.showElements(".show\\:payment--directdebit");break;default:return}}triggerPaymentType(){document.querySelectorAll(".en__field--paymenttype").forEach(t=>{["DOMNodeInserted","change"].forEach(n=>{t.addEventListener(n,()=>{let s=()=>{setTimeout(()=>{this.showPaymentType()},500)};s(),document.querySelectorAll('input[type=radio][name="transaction.paymenttype"]').forEach(function(r){r.addEventListener("change",s)})})})}),document.querySelectorAll('input[type=radio][name="transaction.paymenttype"]').forEach(t=>{t.addEventListener("change",()=>{this.showPaymentType()})}),setTimeout(()=>{this.showPaymentType()},500)}};var p=class{constructor(){this.shouldRun()&&this.run()}shouldRun(){return!!document.querySelector(".social-share-native-link")}run(){let e=document.querySelector(".social-share-native-link"),t=document.querySelector(".social-share-native-title"),n=document.querySelector(".social-share-native-description");if("navigator"in window&&"share"in window.navigator){let s=document.createElement("button");s.setAttribute("type","button"),s.setAttribute("aria-label","Share"),s.classList.add("social-share-native-button"),s.textContent="Share",e.appendChild(s),s.addEventListener("click",()=>{let i={url:e.querySelector("p").textContent.trim()};t&&(i.title=t.textContent.trim()),n&&(i.text=n.textContent.trim()),window.navigator.share(i)})}else{let s=document.createElement("button");s.setAttribute("type","button"),s.setAttribute("aria-label","Copy"),s.classList.add("social-share-native-button"),s.textContent="Copy",e.appendChild(s),s.addEventListener("click",()=>{let i=document.createRange();i.selectNode(e.querySelector("p")),window.getSelection().removeAllRanges(),window.getSelection().addRange(i),document.execCommand("copy"),window.getSelection().removeAllRanges(),s.textContent="Copied!",s.setAttribute("disabled","disabled"),setTimeout(()=>{s.textContent="Copy",s.removeAttribute("disabled")},2e3)})}}};var g=class{constructor(){this.readMoreSections=document.querySelectorAll("[class*='enx-read-more-mobile']"),this.readMoreSections.length>0&&this.addReadMoreSections()}addReadMoreSections(){this.readMoreSections.forEach(e=>{let t=/enx-read-more-mobile\[([0-9])]/gi.exec(e.className);t=t?parseInt(t[1]):2;let n=[...e.children].slice(t),s=document.createElement("div");s.className="enx-read-more-content-mobile",n.forEach(i=>{s.appendChild(i)}),e.appendChild(s),s.insertAdjacentHTML("beforebegin",`<a style="text-decoration: none; cursor: pointer;" class="enx-read-more-toggle-mobile">
          Read more
          <svg
            class="rm-icon-normal ml-2"
            width="15"
            height="15"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M12 9v6m3-3H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <svg
            class="rm-icon-expanded ml-2"
            width="15"
            height="15"
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M15 12H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
        </a>`)}),document.querySelectorAll(".enx-read-more-toggle-mobile").forEach(e=>{e.addEventListener("click",()=>{e.closest('[class*="enx-read-more-mobile"]').classList.toggle("enx-read-more-mobile--open")})})}};var l=class{constructor(e={}){let t={proxies:[],beforeInit:()=>{},beforeCloakRemoval:()=>{},afterInit:()=>{}};this.config={...t,...e},window.hasOwnProperty("ENXPageConfig")&&(this.config={...this.config,...window.ENXPageConfig}),window.ENXConfig=this.config,this.config.beforeInit(),this.waitForEnDefaults().then(()=>{this.helpers=x,this.model=new c,this.proxyFields=new u(this.config.proxies),this.multiStepForm=new h,this.show=new m,this.nativeShare=new p,this.readMoreMobile=new g,this.config.beforeCloakRemoval(),this.cloak=new d,this.config.afterInit()})}waitForEnDefaults(){return new Promise(e=>{function t(){window.EngagingNetworks.require._defined.enDefaults!==void 0?e():setTimeout(t,50)}t()})}};window.ENX=l;var W=l;})();
